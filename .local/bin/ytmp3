#!/bin/sh
cd /home/jordy/to_check/listen
if [ -n $1 ]; then
	VAR=$(xclip -o)
else
	VAR=$1
fi

# check if it is a correct url
regex='(https?|ftp|file)://[-[:alnum:]\+&@#/%?=~_|!:,.;]*[-[:alnum:]\+&@#/%=~_|]'
if [[ $VAR =~ $regex  || ${#VAR} -eq 11 ]]
then
	notify-send -t 2000 -u low "Downloading $VAR" &
	yt-dlp --extract-audio --add-metadata --xattrs --embed-thumbnail --audio-quality 0 --audio-format mp3 --remux-video 'webp>mp3/mp3' -i $VAR
	notify-send -t 2000 -u low "Finished $VAR" &
else
	notify-send -t 2000 -u low "Unable to download, no url" &
fi
