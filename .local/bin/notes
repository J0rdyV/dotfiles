#!/bin/sh

# cat ~/.local/share/notes | dmenu >> ~/.local/share/notes

FILE="${XDG_DATA_HOME:-$HOME/.local/share}/notes"
LOGFILE="${XDG_DATA_HOME:-$HOME/.local/share}/notes_log"

if [[ -n $1 ]]; then
	STRING=$1
else
	STRING=$(cat ${FILE} | sort -r | dmenu -l 20 -p Notes)
fi

if [[ ! -z $(grep -m 1 -x -F "$STRING" "$FILE") ]]; then 
	sed -i "/$STRING/d" $FILE
	echo -n $STRING | sed "s/^.*- //" | xclip
elif [ -n "$STRING" ]; then
	echo $STRING | ts '%Y-%m-%d %H:%M:%S -' >> ${FILE}
	echo $STRING | ts '%Y-%m-%d %H:%M:%S -' >> ${LOGFILE}
fi

